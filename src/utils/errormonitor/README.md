## 日志上报
前端日志上报方案主要分为两种类型：‌实时上报‌和‌异步上报‌，具体选择取决于业务需求和兼容性要求。

### 实时上报方案

#### XMLHttpRequest （XHR）
兼容性：极好

支持同步/异步请求，同步请求会阻塞主线程，异步请求在页面关闭前未发送的请求会被取消

需处理服务器响应，同步请求可能导致页面卡顿，异步请求可能因页面关闭导致数据丢失

#### Fetch API ‌
兼容性：IE11以上
支持GET/POST请求，可携带复杂头部信息（如认证信息），支持大体积数据

受CORS限制，需服务器支持跨域请求

### 异步上报方案

#### ‌ Image上报 ‌
通过动态创建Image对象加载透明GIF图片，将数据编码到URL的query参数中

兼容性极佳（支持IE至现代浏览器），不受CORS限制，几乎不影响页面性能

请求量受URL长度限制（一般2KB左右），仅支持GET请求，无法获取发送成功/失败的回调

#### SendBeacon
navigator.sendBeacon() 是浏览器提供的专门用于在页面卸载时可靠发送少量数据的 API，主要用于日志上报、用户行为统计等场景

兼容性：一般

异步发送少量数据至服务器，使用POST请求（相对GET更不友好）

脱离当前页面，数据可靠性较高

### 选择建议
实时性要求高‌：优先选择XHR或Fetch API，需处理服务器响应

兼容性优先‌：Image上报兼容所有浏览器且无需处理响应

数据可靠性要求高‌：SendBeacon适合关键数据上报